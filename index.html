<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Streamhub Music+</title>
<style>
  /* Fonts import */
  @import url('https://fonts.googleapis.com/css2?family=Inter&family=Press+Start+2P&display=swap');

  :root {
    --background-dark: #1A1A2E;
    --background-light: #F0F0F3;
    --card-dark: #483D8B;
    --card-light: #DDD9F3;
    --highlight: #8A2BE2;
    --text-primary-dark: #FFFFFF;
    --text-secondary-dark: #E0E0E0;
    --text-primary-light: #1A1A2E;
    --text-secondary-light: #555;
    --font-modern: 'Inter', sans-serif;
    --font-retro: 'Press Start 2P', cursive;
  }

  body {
    margin: 0; padding: 0;
    font-family: var(--font-modern);
    background-color: var(--background-dark);
    color: var(--text-primary-dark);
    transition: background-color 0.3s, color 0.3s;
    overflow-x: hidden;
    min-height: 100vh;
  }
  body.light {
    background-color: var(--background-light);
    color: var(--text-primary-light);
  }

  /* Pixel Retro Animations */
  @keyframes pixel-sparkle {
    0%, 100% {opacity: 1; transform: scale(1);}
    50% {opacity: 0.3; transform: scale(1.3);}
  }
  .pixel-sparkle {
    display: inline-block;
    animation: pixel-sparkle 1.2s ease-in-out infinite;
  }
  @keyframes meloncat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
  .meloncat {
    animation: meloncat 0.6s ease-in-out infinite;
  }

  /* Scrollbar for desktop */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background-color: var(--highlight);
    border-radius: 8px;
  }

  /* Utility */
  .hidden { display: none !important; }
  a { 
    color: inherit; 
    text-decoration: none; 
  }
  a:hover {
    color: var(--highlight);
  }
  button {
    font-family: var(--font-modern);
    cursor: pointer;
    border: none;
    border-radius: 4px;
    transition: background-color 0.3s;
    user-select:none;
  }
  input, select, textarea {
    font-family: var(--font-modern);
    border-radius: 4px;
    border: 1.5px solid var(--card-dark);
    padding: 6px 10px;
    background-color: transparent;
    color: inherit;
    transition: border-color 0.3s;
  }
  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--highlight);
  }

  /* Header */
  header {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: 56px;
    background-color: var(--card-dark);
    display: flex;
    align-items: center;
    padding: 0 16px;
    z-index: 9999;
    box-shadow: 0 1px 10px rgba(0,0,0,0.4);
  }
  body.light header {
    background-color: var(--card-light);
  }
  .logo {
    display: flex;
    align-items: center;
    font-family: var(--font-retro);
    font-weight: 700;
    font-size: 20px;
    color: var(--highlight);
    letter-spacing: 2px;
    user-select:none;
  }
  .logo-icon {
    width: 28px;
    height: 28px;
    margin-right: 8px;
    image-rendering: pixelated;
  }

  nav {
    margin-left: 24px;
    display:flex;
    gap: 14px;
    flex-wrap: nowrap;
    overflow-x: auto;
  }
  nav a {
    font-weight: 600;
    padding: 8px 12px;
    border-radius: 6px;
    white-space: nowrap;
  }
  nav a.active, nav a:hover {
    background-color: var(--highlight);
    color: #111;
  }

  /* Search bar */
  .search-bar-container {
    position: relative;
    margin-left: auto;
    max-width: 320px;
    flex-shrink: 0;
  }
  #search-input {
    width: 100%;
    padding: 8px 36px 8px 12px;
    font-size: 14px;
    border-radius: 18px;
    border: none;
    background-color: rgba(255 255 255 / 0.1);
    color: var(--text-primary-dark);
    font-family: var(--font-modern);
    transition: background-color 0.3s;
  }
  body.light #search-input {
    background-color: rgba(0 0 0 / 0.1);
    color: var(--text-primary-light);
  }
  #search-input::placeholder {
    color: var(--text-secondary-dark);
  }
  #search-input:focus {
    outline: none;
    background-color: rgba(255 255 255 / 0.2);
  }
  #search-clear-btn {
    position: absolute;
    right: 8px; top: 50%;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    font-size: 18px;
    color: var(--text-secondary-dark);
    cursor: pointer;
    padding: 0;
  }
  #search-clear-btn:hover {
    color: var(--highlight);
  }
  .search-suggestions {
    position: absolute;
    top: calc(100% + 4px);
    left: 0; right: 0;
    background-color: var(--card-dark);
    border-radius: 8px;
    max-height: 180px;
    overflow-y: auto;
    z-index: 9999;
    box-shadow: 0 8px 16px rgba(0,0,0,0.5);
  }
  body.light .search-suggestions {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  .search-suggestions div {
    padding: 8px 12px;
    border-bottom: 1px solid rgba(200 200 200 / 0.1);
    cursor: pointer;
    font-size: 14px;
  }
  .search-suggestions div:hover {
    background-color: var(--highlight);
    color: #111;
  }

  /* Avatar */
  .avatar {
    margin-left: 16px;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    object-fit: cover;
    background-color: var(--highlight);
    cursor: pointer;
    flex-shrink: 0;
  }

  /* Theme switch */
  #theme-toggle {
    margin-left: 12px;
    background: none;
    border: 2px solid var(--highlight);
    width: 36px;
    height: 24px;
    border-radius: 16px;
    position: relative;
  }
  #theme-toggle:before {
    content: "";
    position: absolute;
    top: 2px; left: 2px;
    width: 20px; height: 20px;
    background-color: var(--highlight);
    border-radius: 50%;
    transition: left 0.3s;
  }
  body.light #theme-toggle:before {
    left: 14px;
  }

  /* Main container */
  main {
    padding-top: 72px;
    padding-left: 16px;
    padding-right: 16px;
    max-width: 1440px;
    margin: 0 auto;
    min-height: calc(100vh - 72px);
  }

  /* Banner Carousel */
  .banner-carousel {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 24px;
    user-select:none;
  }
  .banner-slide {
    display: none;
    position: relative;
    height: 160px;
    background: #483D8B;
    color: var(--text-primary-dark);
    font-family: var(--font-retro);
    font-size: 24px;
    font-weight: 700;
    letter-spacing: 3px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0 32px;
    text-shadow: 1px 1px 3px black;
  }
  .banner-slide.active {
    display: flex;
    animation: pixel-fade 1.2s ease forwards;
  }
  @keyframes pixel-fade {
    from {opacity: 0;}
    to {opacity: 1;}
  }
  .banner-buttons {
    position: absolute;
    bottom: 14px; left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 18px;
  }
  .banner-buttons button {
    font-family: var(--font-retro);
    font-size: 16px;
    background-color: var(--highlight);
    color: #111;
    padding: 10px 20px;
    border-radius: 16px;
    font-weight: 700;
    box-shadow: 0 0 6px var(--highlight);
  }
  .banner-buttons button:hover {
    animation: meloncat 0.6s ease-in-out infinite;
  }

  /* Horizontal slider for categories */
  .category-slider {
    display: flex;
    overflow-x: auto;
    gap: 16px;
    padding-bottom: 8px;
  }
  .category-slider::-webkit-scrollbar {
    height: 10px;
  }
  .category-slider::-webkit-scrollbar-thumb {
    background-color: var(--highlight);
    border-radius: 10px;
  }
  .category-card {
    flex: 0 0 auto;
    background-color: var(--card-dark);
    color: var(--text-primary-dark);
    border-radius: 12px;
    min-width: 180px;
    height: 120px;
    font-family: var(--font-retro);
    font-size: 18px;
    font-weight: 700;
    box-shadow: 0 2px 8px rgba(0,0,0,0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: box-shadow 0.3s;
  }
  .category-card:hover {
    box-shadow: 0 0 14px var(--highlight);
  }
  body.light .category-card {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }

  /* Musik Terbaru slider on homepage */
  #latest-music-slider {
    margin-top: 24px;
  }
  #latest-music-slider h3 {
    font-family: var(--font-retro);
    font-weight: 700;
    margin-bottom: 12px;
  }
  #latest-music-list {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 12px;
  }
  #latest-music-list::-webkit-scrollbar {
    height: 10px;
  }
  #latest-music-list::-webkit-scrollbar-thumb {
    background-color: var(--highlight);
    border-radius: 10px;
  }
  .latest-music-card {
    flex: 0 0 auto;
    background-color: var(--card-dark);
    border-radius: 10px;
    width: 140px;
    cursor: pointer;
    box-shadow: 0 3px 8px rgba(0,0,0,0.6);
    transition: box-shadow 0.3s ease;
    user-select:none;
  }
  .latest-music-card:hover {
    box-shadow: 0 0 18px var(--highlight);
  }
  body.light .latest-music-card {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  .latest-music-thumb {
    width: 100%;
    height: 120px;
    object-fit: cover;
    image-rendering: pixelated;
    border-radius: 10px 10px 0 0;
  }
  .latest-music-info {
    padding: 6px 8px 8px 8px;
    font-size: 13px;
    color: var(--text-primary-dark);
  }
  body.light .latest-music-info {
    color: var(--text-primary-light);
  }
  .latest-music-title {
    font-weight: 700;
    font-family: var(--font-retro);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .latest-music-artist {
    font-weight: 400;
    color: var(--text-secondary-dark);
  }
  body.light .latest-music-artist {
    color: var(--text-secondary-light);
  }

  /* Multi page wrapper */
  .page {
    display: none;
  }
  .page.active {
    display: block;
  }

  /* Music Page Styles */
  #music-page {
    display: flex;
    flex-direction: row;
    gap: 12px;
  }
  #music-sidebar {
    background-color: var(--card-dark);
    border-radius: 12px;
    width: 220px;
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  body.light #music-sidebar {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  #music-sidebar h3 {
    font-family: var(--font-retro);
    font-size: 16px;
    margin: 0 0 8px 0;
  }
  #music-sidebar button {
    background: none;
    color: inherit;
    font-weight: 600;
    text-align: left;
    padding: 8px 10px;
    border-radius: 8px;
    width: 100%;
  }
  #music-sidebar button.active,
  #music-sidebar button:hover {
    background-color: var(--highlight);
    color: #111;
  }

  #music-main {
    flex-grow: 1;
    border-radius: 12px;
    background-color: var(--card-dark);
    padding: 16px;
    overflow-y: auto;
    max-height: 80vh;
  }
  body.light #music-main {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }

  #music-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(140px,1fr));
    gap: 12px;
  }
  .music-card {
    background-color: var(--background-dark);
    border-radius: 10px;
    cursor: pointer;
    overflow: hidden;
    box-shadow: 0 3px 10px rgba(0,0,0,0.5);
    transition: transform 0.3s ease;
  }
  .music-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 0 16px var(--highlight);
  }
  body.light .music-card {
    background-color: #eee;
  }
  .music-thumb {
    width: 100%;
    height: 120px;
    object-fit: cover;
    image-rendering: pixelated;
  }
  .music-info {
    padding: 8px 6px;
    font-size: 13px;
    color: var(--text-primary-dark);
  }
  body.light .music-info {
    color: var(--text-primary-light);
  }
  .music-title {
    font-weight: 700;
    font-family: var(--font-retro);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .music-artist {
    font-weight: 400;
    color: var(--text-secondary-dark);
  }
  body.light .music-artist {
    color: var(--text-secondary-light);
  }

  /* Modal Music Player */
  #music-player-modal {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translate(-50%, 100%);
    width: 100%;
    max-width: 480px;
    max-height: 70vh;
    background-color: var(--card-dark);
    border-radius: 20px 20px 0 0;
    padding: 24px 24px 48px 24px;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.8);
    transition: transform 0.4s ease;
    z-index: 99999;
    display: flex;
    flex-direction: column;
    gap: 18px;
  }
  body.light #music-player-modal {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  #music-player-modal.active {
    transform: translate(-50%, 0);
  }
  #player-album-art {
    width: 100%;
    max-height: 240px;
    object-fit: contain;
    image-rendering: pixelated;
    border-radius: 12px;
  }
  #player-title {
    font-family: var(--font-retro);
    font-weight: 700;
    font-size: 20px;
  }
  #player-artist {
    font-weight: 600;
    font-size: 16px;
    color: var(--highlight);
  }
  #player-lyrics {
    font-family: var(--font-modern);
    font-size: 14px;
    line-height: 1.4;
    height: 120px;
    overflow-y: auto;
    background-color: rgba(255 255 255 / 0.05);
    border-radius: 10px;
    padding: 12px;
    color: var(--text-secondary-dark);
  }
  body.light #player-lyrics {
    background-color: rgba(0 0 0 / 0.1);
    color: var(--text-secondary-light);
  }
  #player-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 24px;
  }
  #player-controls button {
    background-color: var(--highlight);
    color: #111;
    padding: 12px 18px;
    font-size: 16px;
    font-family: var(--font-retro);
    border-radius: 12px;
    font-weight: 700;
  }
  #music-player-close-btn {
    position: absolute;
    top: 8px;
    right: 12px;
    background: transparent;
    color: var(--highlight);
    font-size: 28px;
    line-height: 24px;
    cursor: pointer;
    user-select:none;
  }
  #music-player-close-btn:hover {
    color: #fff;
    text-shadow: 0 0 6px var(--highlight);
  }

  /* Video Page */
  #video-page {
    display: flex;
    gap: 12px;
  }
  #video-player-section {
    flex: 2;
    background-color: var(--card-dark);
    border-radius: 12px;
    padding: 12px;
    display: flex;
    flex-direction: column;
  }
  body.light #video-player-section {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  #video-player {
    width: 100%;
    max-height: 360px;
    border-radius: 12px;
    background-color: black;
  }
  #video-info {
    margin-top: 12px;
  }
  .video-buttons {
    margin-top: 8px;
    display: flex;
    gap: 12px;
  }
  .video-buttons button {
    background-color: var(--highlight);
    border-radius: 10px;
    font-family: var(--font-retro);
    color: #111;
    font-weight: 700;
    padding: 8px 14px;
  }
  .video-buttons button:hover {
    animation: meloncat 0.6s ease-in-out infinite;
  }

  #video-comments-section {
    flex: 1;
    background-color: var(--card-dark);
    border-radius: 12px;
    padding: 12px;
    height: 420px;
    overflow-y: auto;
  }
  body.light #video-comments-section {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  #video-comments-section h3 {
    font-family: var(--font-retro);
    margin-top: 0;
  }
  #comments-list {
    font-size: 14px;
    line-height: 1.3;
  }
  .comment {
    padding: 6px 8px;
    border-bottom: 1px solid rgba(200 200 200 / 0.1);
  }
  .comment strong {
    color: var(--highlight);
    font-weight: 700;
  }
  .comment .timestamp {
    font-size: 11px;
    color: var(--text-secondary-dark);
    float: right;
  }
  body.light .comment .timestamp {
    color: var(--text-secondary-light);
  }
  #add-comment {
    margin-top: 12px;
    display: flex;
    gap: 8px;
  }
  #add-comment textarea {
    flex-grow: 1;
    resize: none;
    border-radius: 12px;
    padding: 8px 12px;
    background-color: rgba(255 255 255 / 0.1);
    border:none;
    color: var(--text-primary-dark);
    font-family: var(--font-modern);
  }
  body.light #add-comment textarea {
    background-color: rgba(0 0 0 / 0.1);
    color: var(--text-primary-light);
  }
  #add-comment button {
    background-color: var(--highlight);
    color: #111;
    font-weight: 700;
    border-radius: 12px;
    padding: 8px 14px;
  }

  /* Live Streaming page */
  #live-page {
    display: flex;
    gap: 12px;
  }
  #live-stream-section {
    flex: 2;
    background-color: var(--card-dark);
    border-radius: 12px;
    padding: 12px;
  }
  body.light #live-stream-section {
    background-color: var(--card-light);
  }
  #live-video-embed {
    width: 100%;
    height: 360px;
    border-radius: 12px;
  }
  #live-selectors {
    margin-top: 12px;
    display: flex;
    gap: 12px;
  }
  #live-selectors button {
    background-color: var(--highlight);
    border-radius: 12px;
    padding: 8px 14px;
    color: #111;
    font-weight: 700;
    cursor: pointer;
  }
  #live-selectors button.active {
    box-shadow: 0 0 15px var(--highlight);
  }
  #live-chat-section {
    flex: 1;
    background-color: var(--card-dark);
    border-radius: 12px;
    padding: 12px;
    height: 480px;
    display: flex;
    flex-direction: column;
  }
  body.light #live-chat-section {
    background-color: var(--card-light);
  }
  #chat-messages {
    flex-grow: 1;
    overflow-y: auto;
    font-size: 14px;
  }
  #chat-input-container {
    margin-top: 8px;
    display: flex;
  }
  #chat-input {
    flex-grow: 1;
    padding: 8px 12px;
    border-radius: 16px;
    font-family: var(--font-modern);
    border: none;
    background-color: rgba(255 255 255 / 0.1);
    color: var(--text-primary-dark);
  }
  body.light #chat-input {
    background-color: rgba(0 0 0 / 0.1);
    color: var(--text-primary-light);
  }
  #chat-send-btn {
    background-color: var(--highlight);
    border-radius: 12px;
    padding: 8px 14px;
    margin-left: 8px;
    color: #111;
    font-weight: 700;
  }
  #live-info {
    font-family: var(--font-retro);
    font-weight: 700;
    font-size: 18px;
    margin-bottom: 10px;
  }
  #live-info span {
    margin-right: 16px;
  }

  /* Profile Page */
  #profile-page {
    max-width: 720px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 24px;
  }
  #profile-header {
    display: flex;
    gap: 24px;
    align-items: center;
  }
  #profile-avatar {
    width: 96px;
    height: 96px;
    border-radius: 50%;
    object-fit: cover;
    background-color: var(--highlight);
    cursor: pointer;
  }
  #upload-avatar-input {
    display: none;
  }
  #profile-info {
    flex-grow: 1;
  }
  #profile-info h2 {
    font-family: var(--font-retro);
    margin: 0 0 8px 0;
  }
  #profile-info textarea,
  #profile-info input {
    width: 100%;
    margin-bottom: 8px;
  }
  #profile-stats {
    display: flex;
    gap: 24px;
    font-size: 14px;
    font-family: var(--font-retro);
  }
  #profile-stats div {
    background-color: var(--card-dark);
    padding: 12px 20px;
    border-radius: 12px;
    flex-grow: 1;
    text-align: center;
    box-shadow: 0 0 14px var(--highlight);
  }
  body.light #profile-stats div {
    background-color: var(--card-light);
  }
  #profile-stats div span {
    display: block;
    font-size: 18px;
    font-weight: 700;
    color: var(--highlight);
  }

  /* Login & Register Pages */
  #login-register-page {
    max-width: 360px;
    margin: 40px auto;
    background-color: var(--card-dark);
    padding: 24px;
    border-radius: 16px;
    box-shadow: 0 0 18px var(--highlight);
  }
  body.light #login-register-page {
    background-color: var(--card-light);
  }
  #login-register-page h2 {
    font-family: var(--font-retro);
    text-align: center;
    margin-bottom: 20px;
  }
  #login-register-page label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  #login-register-page input {
    width: 100%;
    padding: 8px;
    margin-bottom: 14px;
    font-size: 14px;
  }
  #login-register-page button {
    width: 100%;
    background-color: var(--highlight);
    color: #111;
    font-weight: 700;
    padding: 12px;
    font-family: var(--font-retro);
  }
  #login-register-page button:hover {
    animation: meloncat 0.6s ease-in-out infinite;
  }
  #login-register-page .links {
    margin-top: 12px;
    font-size: 13px;
    text-align: center;
  }
  #login-register-page .links a {
    color: var(--highlight);
    cursor: pointer;
  }

  /* Search Results Page */
  #search-page {
    max-width: 1040px;
    margin: 0 auto;
  }
  #search-filters {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
  }
  #search-filters button {
    font-family: var(--font-retro);
    background-color: var(--card-dark);
    color: var(--text-primary-dark);
    padding: 10px 20px;
    border-radius: 12px;
    font-weight: 700;
  }
  #search-filters button.active,
  #search-filters button:hover {
    background-color: var(--highlight);
    color: #111;
  }
  body.light #search-filters button {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  #search-results {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(180px,1fr));
    gap: 16px;
  }
  .search-result-card {
    background-color: var(--card-dark);
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    box-shadow: 0 3px 10px rgba(0,0,0,0.5);
    transition: transform 0.3s ease;
  }
  .search-result-card:hover {
    transform: translateY(-7px);
    box-shadow: 0 0 22px var(--highlight);
  }
  body.light .search-result-card {
    background-color: var(--card-light);
    color: var(--text-primary-light);
  }
  .search-result-thumb {
    width: 100%;
    height: 120px;
    object-fit: cover;
    image-rendering: pixelated;
  }
  .search-result-info {
    padding: 8px 10px;
    font-family: var(--font-modern);
  }
  .search-result-title {
    font-family: var(--font-retro);
    font-weight: 700;
    font-size: 14px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .search-result-meta {
    font-size: 12px;
    color: var(--text-secondary-dark);
  }
  body.light .search-result-meta {
    color: var(--text-secondary-light);
  }

  /* Responsive */
  @media (max-width: 768px) {
    nav {
      display: none;
    }
    #music-page {
      flex-direction: column;
    }
    #music-sidebar {
      width: 100%;
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 8px;
    }
    #music-sidebar button {
      flex: 0 0 auto;
      width: auto;
      white-space: nowrap;
    }
    #music-main {
      max-height: none;
    }
    #video-page {
      flex-direction: column;
    }
    #video-comments-section {
      height: 240px;
    }
    #live-page {
      flex-direction: column;
    }
    #live-chat-section {
      height: 240px;
    }
    #latest-music-list {
      gap: 8px;
    }
  }
  @media (max-width: 480px) {
    .category-card {
      min-width: 140px;
      font-size: 14px;
    }
    #banner-buttons button {
      font-size: 12px;
      padding: 8px 14px;
    }
  }

  /* Loading Animation */
  #loading-overlay {
    position: fixed;
    top: 0; left:0; right:0; bottom:0;
    background: var(--background-dark);
    display: flex;
    justify-content:center;
    align-items:center;
    z-index: 100000;
    font-family: var(--font-retro);
    font-size: 22px;
    color: var(--highlight);
  }
  .pixel-dot {
    display: inline-block;
    margin: 0 3px;
    font-weight: 900;
    animation: pixel-sparkle 1.4s infinite;
  }
  .pixel-dot:nth-child(2) {animation-delay: 0.2s;}
  .pixel-dot:nth-child(3) {animation-delay: 0.4s;}
  .pixel-dot:nth-child(4) {animation-delay: 0.6s;}
</style>
</head>
<body>

<header>
  <div class="logo" aria-label="Logo Streamhub Music+">
    <canvas id="logo-pixel" width="32" height="32" style="image-rendering: pixelated; margin-right: 8px;"></canvas>
    Streamhub Music+
  </div>
  <nav aria-label="Main navigation" role="navigation">
    <a href="#home" class="nav-link active" data-page="home">Beranda</a>
    <a href="#music" class="nav-link" data-page="music">Musik</a>
    <a href="#video" class="nav-link" data-page="video">Video</a>
    <a href="#trending" class="nav-link" data-page="trending">Trending</a>
    <a href="#live" class="nav-link" data-page="live">Live</a>
    <a href="#profile" class="nav-link" data-page="profile">Profil</a>
  </nav>
  <div class="search-bar-container" role="search" aria-label="Search music, video, and live">
    <input type="search" id="search-input" placeholder="Cari..." aria-label="Search" autocomplete="off" />
    <button id="search-clear-btn" aria-label="Clear search input">&times;</button>
    <div class="search-suggestions hidden" id="search-suggestions" role="listbox"></div>
  </div>
  <img src="https://i.pravatar.cc/36?u=random" alt="User avatar" class="avatar" id="user-avatar" />
  <button id="theme-toggle" aria-label="Toggle theme"></button>
</header>

<main>
  <!-- Loading overlay -->
  <div id="loading-overlay" class="hidden" aria-live="assertive" aria-label="Loading content">
    ▲ ■ ▼<span class="pixel-dot">●</span><span class="pixel-dot">●</span><span class="pixel-dot">●</span>
  </div>

  <!-- Home Page -->
  <section id="home" class="page active" role="main" aria-label="Homepage">
    <div class="banner-carousel" aria-roledescription="carousel" aria-label="Promotional banners">
      <div class="banner-slide active" data-index="0" role="group" aria-roledescription="slide" aria-label="Tonton Sekarang">
        🎧 Tonton Sekarang
      </div>
      <div class="banner-slide" data-index="1" role="group" aria-roledescription="slide" aria-label="Trending Hari Ini">
        🔥 Trending Hari Ini
      </div>
      <div class="banner-buttons">
        <button aria-controls="banner-carousel" data-index="0" aria-label="Tonton Sekarang Banner Button">🎧 Tonton Sekarang</button>
        <button aria-controls="banner-carousel" data-index="1" aria-label="Trending Hari Ini Banner Button">🔥 Trending Hari Ini</button>
      </div>
    </div>

    <div class="category-slider" aria-label="Kategori utama">
      <div class="category-card" role="button" tabindex="0" data-target-page="music">Musik Terbaru</div>
      <div class="category-card" role="button" tabindex="0" data-target-page="video">Trending Video Musik</div>
      <div class="category-card" role="button" tabindex="0" data-target-page="live">Live Performance</div>
      <div class="category-card" role="button" tabindex="0" data-target-page="profile">Playlist Buatan Pengguna</div>
      <div class="category-card" role="button" tabindex="0" data-target-page="profile">Rekomendasi Untukmu</div>
      <div class="category-card" role="button" tabindex="0" data-target-page="profile">Rekomendasi Berdasarkan Riwayat</div>
    </div>

    <!-- Musik Terbaru Slider -->
    <section id="latest-music-slider" aria-label="Musik Terbaru">
      <h3>Musik Terbaru</h3>
      <div id="latest-music-list" aria-live="polite" tabindex="0">
        <!-- latest music cards loaded here dynamically -->
      </div>
    </section>
  </section>

  <!-- Music Page -->
  <section id="music" class="page" role="main" aria-label="Halaman Musik">
    <div id="music-sidebar" aria-label="Sidebar Musik">
      <h3>Playlist Saya</h3>
      <button class="music-menu-btn active" data-menu="playlist">Playlist Saya</button>
      <button class="music-menu-btn" data-menu="liked">Lagu yang Disukai</button>
      <button class="music-menu-btn" data-menu="history">History Pemutaran</button>
      <button class="music-menu-btn" data-menu="genre">Eksplorasi Genre</button>
    </div>
    <div id="music-main" aria-live="polite">
      <div id="music-grid" aria-label="Grid lagu musik">
        <!-- Music cards inserted here -->
      </div>
    </div>
    <!-- Modal Music Player -->
    <section id="music-player-modal" aria-label="Music player widget" aria-hidden="true" tabindex="-1">
      <button id="music-player-close-btn" aria-label="Close music player">&times;</button>
      <img id="player-album-art" src="" alt="Album art" />
      <div id="player-title">Title</div>
      <div id="player-artist">Artist</div>
      <div id="player-lyrics"></div>
      <div id="player-controls">
        <button id="prev-btn" aria-label="Previous song">&#9664;&#9664;</button>
        <button id="play-pause-btn" aria-label="Play/Pause">&#9654;</button>
        <button id="next-btn" aria-label="Next song">&#9654;&#9654;</button>
      </div>
    </section>
  </section>

  <!-- Video Page -->
  <section id="video" class="page" role="main" aria-label="Halaman Video Musik">
    <div id="video-player-section">
      <iframe id="video-player" allowfullscreen frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" style="width:100%; height:360px; border-radius:12px;"></iframe>
      <div id="video-info">
        <div><strong>Channel:</strong> <span id="video-channel">7clouds Media</span></div>
        <div><strong>Views:</strong> <span id="video-views">loading...</span></div>
        <div><strong>Tanggal:</strong> <span id="video-date">loading...</span></div>
      </div>
      <div class="video-buttons">
        <button id="like-btn" aria-pressed="false">Like 👍</button>
        <button id="dislike-btn" aria-pressed="false">Dislike 👎</button>
        <button id="share-btn">Bagikan 📤</button>
        <button id="subscribe-btn" aria-pressed="false">Subscribe</button>
      </div>
      <div id="recommended-videos" aria-label="Rekomendasi video"></div>
    </div>
    <div id="video-comments-section" aria-live="polite">
      <h3>Komentar</h3>
      <div id="comments-list" aria-label="Daftar komentar"></div>
      <form id="add-comment" aria-label="Tambah komentar">
        <textarea id="comment-text" rows="2" placeholder="Tulis komentar..." required aria-required="true"></textarea>
        <button type="submit">Kirim</button>
      </form>
    </div>
  </section>

  <!-- Live Page -->
  <section id="live" class="page" role="main" aria-label="Halaman Live Streaming">
    <div id="live-stream-section">
      <iframe id="live-video-embed" src="" allowfullscreen allow="autoplay; encrypted-media" frameborder="0" ></iframe>
      <div id="live-selectors" role="group" aria-label="Select live stream">
        <button data-videoid="U4Ux0ePA_2U" class="active">Live 1</button>
        <button data-videoid="lOK8WcyVmSQ">Live 2</button>
        <button data-videoid="36YnV9STBqc">Live 3</button>
      </div>
      <div id="live-info">
        <span>Penonton aktif: <span id="live-viewers">0</span></span>
        <button id="btn-follow">Follow</button>
        <button id="btn-donate">Donate</button>
      </div>
    </div>
    <div id="live-chat-section" aria-live="polite" aria-label="Chat realtime streaming artist">
      <div id="chat-messages" tabindex="0"></div>
      <div id="chat-input-container">
        <input type="text" id="chat-input" placeholder="Tulis chat..." aria-label="Tulis chat" />
        <button id="chat-send-btn">Kirim</button>
      </div>
    </div>
  </section>

  <!-- Profile Page -->
  <section id="profile" class="page" role="main" aria-label="Halaman Profil Pengguna">
    <div id="profile-page">
      <div id="profile-header">
        <img src="https://i.pravatar.cc/96?u=profile" alt="Avatar Profil" id="profile-avatar" tabindex="0" />
        <input type="file" accept="image/*" id="upload-avatar-input" aria-label="Upload avatar" />
        <div id="profile-info">
          <h2 contenteditable="true" id="profile-name" aria-label="Nama pengguna">Nama Pengguna</h2>
          <textarea id="profile-bio" placeholder="Bio kamu..."></textarea>
        </div>
      </div>
      <div id="profile-stats">
        <div><span id="stat-songs-played">0</span>Lagu diputar</div>
        <div><span id="stat-videos-watched">0</span>Video ditonton</div>
        <div><span id="stat-songs-liked">0</span>Lagu disukai</div>
        <div><span id="stat-playlists">0</span>Koleksi playlist</div>
      </div>
    </div>
  </section>

  <!-- Login/Register Page -->
  <section id="login-register" class="page" role="main" aria-label="Halaman Login dan Daftar">
    <div id="login-register-page">
      <h2 id="form-title">Login</h2>
      <form id="login-form">
        <label for="login-email">Email</label>
        <input type="email" id="login-email" required />
        <label for="login-password">Password</label>
        <input type="password" id="login-password" required />
        <button type="submit">Login</button>
        <div class="links">
          <span><a href="#" id="forgot-password-link">Lupa password?</a></span> | 
          <span><a href="#" id="switch-to-register">Belum punya akun?</a></span>
        </div>
      </form>
      <form id="register-form" class="hidden" novalidate>
        <label for="register-name">Nama</label>
        <input type="text" id="register-name" required />
        <label for="register-email">Email</label>
        <input type="email" id="register-email" required />
        <label for="register-password">Password</label>
        <input type="password" id="register-password" required />
        <button type="submit">Buat Akun</button>
        <div class="links">
          <span><a href="#" id="switch-to-login">Sudah punya akun?</a></span>
        </div>
      </form>
    </div>
  </section>

  <!-- Search Page -->
  <section id="search" class="page" role="main" aria-label="Halaman Pencarian">
    <div id="search-filters" role="tablist" aria-label="Filter hasil pencarian">
      <button role="tab" aria-selected="true" aria-controls="results-all" data-filter="all" class="active">Semua</button>
      <button role="tab" aria-selected="false" aria-controls="results-music" data-filter="music">Musik</button>
      <button role="tab" aria-selected="false" aria-controls="results-video" data-filter="video">Video</button>
      <button role="tab" aria-selected="false" aria-controls="results-live" data-filter="live">Live</button>
    </div>
    <div id="search-results" aria-live="polite" aria-atomic="true"></div>
  </section>

</main>

<script>
  // Global State
  const state = {
    currentPage: 'home',
    darkMode: true,
    userLoggedIn: false,
    userData: null,
    playlist: [],
    likedSongs: [],
    playHistory: [],
    musicData: [],
    videoData: [],
    liveData: [],
    liveViewers: 124,
    videoLiked: false,
    videoDisliked: false,
    subscribed: false,
    comments: [],
    chatMessages: [],
    searchHistory: [],
    searchSuggestions: [],
    searchResults: [],
    latestMusic: [],
    currentSongIndex: -1,
    isPlaying: false,
    // For video listing from YouTube API simulation
    youtubeVideos: [],
  };

  const YT_CHANNEL_ID = 'UCFMZHFh2H7m8-P80HtYRDjg'; // 7clouds YouTube channel id

  // Elements refs
  const pages = document.querySelectorAll('.page');
  const navLinks = document.querySelectorAll('.nav-link');
  const themeToggleBtn = document.getElementById('theme-toggle');
  const body = document.body;
  const loadingOverlay = document.getElementById('loading-overlay');
  const avatarImg = document.getElementById('user-avatar');

  // Logo pixel canvas draw
  const logoPixelCanvas = document.getElementById('logo-pixel');
  const logoCtx = logoPixelCanvas.getContext('2d');
  function drawLogoPixel() {
    const px = 4;
    logoCtx.clearRect(0,0,32,32);
    logoCtx.fillStyle = '#8A2BE2';
    logoCtx.fillRect(12, 18, px*3, px*3);
    logoCtx.fillStyle = '#483D8B';
    logoCtx.fillRect(15, 21, px*1.5, px*1.5);
    logoCtx.fillStyle = '#fff';
    logoCtx.fillRect(13, 19, px*1.5, px*1.5);
    logoCtx.fillStyle = '#8A2BE2';
    logoCtx.fillRect(15, 6, px, 14);
    logoCtx.fillRect(16, 5, px, 1);
  }
  drawLogoPixel();

  // Theme toggle
  function setTheme(dark) {
    state.darkMode = dark;
    if (dark){
      body.classList.remove('light');
    } else {
      body.classList.add('light');
    }
    localStorage.setItem('darkMode', JSON.stringify(dark));
  }
  themeToggleBtn.addEventListener('click', () => {
    setTheme(!state.darkMode);
  });
  const savedTheme = JSON.parse(localStorage.getItem('darkMode'));
  if (typeof savedTheme === 'boolean'){
    setTheme(savedTheme);
  } else {
    setTheme(true);
  }

  // Navigation
  function setActivePage(pageId) {
    pages.forEach(p => p.classList.toggle('active', p.id === pageId));
    navLinks.forEach(l => l.classList.toggle('active', l.dataset.page === pageId));
    state.currentPage = pageId;
    hideSearchSuggestions();

    if(pageId === 'music') renderMusicGrid('playlist');
    if(pageId === 'video') {
      if(state.youtubeVideos.length === 0){
        fetchYouTubeVideos();
      }
      renderVideoCurrent(0);
    }
    if(pageId === 'live'){
      setupLiveStreams();
    }
    if(pageId === 'profile'){
      loadUserProfile();
    }
    if(pageId === 'login-register'){
      showLogin();
    }
    if(pageId === 'search'){
      renderSearchResults('all');
    }
    if(pageId === 'home'){
      fetchLatestMusic();
    }
  }
  navLinks.forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      setActivePage(link.dataset.page);
    });
  });

  // Category cards navigation
  document.querySelectorAll('.category-card').forEach(card => {
    card.addEventListener('click', () => {
      const tgt = card.dataset.targetPage;
      if(tgt) setActivePage(tgt);
    });
    card.addEventListener('keypress', e => {
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        const tgt = card.dataset.targetPage;
        if(tgt) setActivePage(tgt);
      }
    });
  });

  // Search bar autocomplete and clear button
  const searchInput = document.getElementById('search-input');
  const searchClearBtn = document.getElementById('search-clear-btn');
  const searchSuggestions = document.getElementById('search-suggestions');
  const dummyDataForSearch = [
    'Lagu cinta', 'Video musik terbaru', 'Live concert', 'Streamhub Music+',
    'Trending hari ini', 'Playlist favorit', 'Jazz music', 'Pop hits',
    'Rock classics', 'Indie vibes', 'Live chat', 'User playlist',
  ];
  const savedSearchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];
  state.searchHistory = savedSearchHistory;

  function updateSearchSuggestions(query) {
    if(!query || query.trim().length === 0){
      const suggestions = [...state.searchHistory].reverse().slice(0,5);
      displaySearchSuggestions(suggestions);
      return;
    }
    let filtered = dummyDataForSearch.filter(s => s.toLowerCase().includes(query.toLowerCase()));
    const historyFiltered = state.searchHistory.filter(h => h.toLowerCase().includes(query.toLowerCase()));
    filtered = filtered.concat(historyFiltered.filter(h => !filtered.includes(h)));
    displaySearchSuggestions(filtered.slice(0,5));
  }
  function displaySearchSuggestions(items){
    searchSuggestions.innerHTML = '';
    if(items.length === 0){
      hideSearchSuggestions();
      return;
    }
    searchSuggestions.classList.remove('hidden');
    items.forEach(item => {
      const div = document.createElement('div');
      div.textContent = item;
      div.tabIndex = 0;
      div.setAttribute('role', 'option');
      div.addEventListener('click', () => performSearch(item));
      div.addEventListener('keypress', e => {
        if(e.key === 'Enter' || e.key === ' '){
          performSearch(item);
        }
      });
      searchSuggestions.appendChild(div);
    });
  }
  function hideSearchSuggestions(){
    searchSuggestions.classList.add('hidden');
  }
  searchInput.addEventListener('input', e => updateSearchSuggestions(e.target.value));
  searchInput.addEventListener('focus', e => updateSearchSuggestions(e.target.value));
  searchClearBtn.addEventListener('click', () => {
    searchInput.value = '';
    updateSearchSuggestions('');
    searchInput.focus();
  });
  document.addEventListener('click', (e) => {
    if(!searchInput.contains(e.target) && !searchSuggestions.contains(e.target)){
      hideSearchSuggestions();
    }
  });
  searchInput.addEventListener('keydown', e => {
    if(e.key === 'Enter'){
      e.preventDefault();
      performSearch(searchInput.value.trim());
    }
  });

  // Perform Search
  function performSearch(query){
    if(!query) return;
    const idx = state.searchHistory.indexOf(query);
    if(idx !== -1) state.searchHistory.splice(idx, 1);
    state.searchHistory.push(query);
    if(state.searchHistory.length > 20) state.searchHistory.shift();
    localStorage.setItem('searchHistory', JSON.stringify(state.searchHistory));
    searchInput.value = query;
    hideSearchSuggestions();
    setActivePage('search');
    filterSearchResults(query);
  }

  // Dummy video/live data for search and UI enhancement
  const dummyLives = [
    {id:1,title:'Streaming Dewi',channel:'Dewi Live',viewers:321},
    {id:2,title:'Concert Lina',channel:'Lina Channel',viewers:150},
  ];
  state.liveData = dummyLives;

  // Music sidebar
  function renderMusicGrid(menu){
    const grid = document.getElementById('music-grid');
    grid.innerHTML = '';
    let songs;
    switch(menu){
      case 'liked':
        songs = state.likedSongs;
        break;
      case 'history':
        songs = state.playHistory;
        break;
      case 'genre':
        songs = state.musicData;
        break;
      default:
        songs = state.musicData;
        break;
    }
    if(songs.length === 0){
      grid.innerHTML = '<p>Belum ada lagu untuk kategori ini.</p>';
      return;
    }
    for(const song of songs){
      const card = document.createElement('div');
      card.className = 'music-card';
      card.tabIndex = 0;
      card.setAttribute('role','button');
      card.dataset.id = song.id;
      card.innerHTML = `
        <img src="${song.albumArt}" alt="Album art ${song.title}" class="music-thumb" />
        <div class="music-info">
          <div class="music-title">${song.title}</div>
          <div class="music-artist">${song.artist}</div>
        </div>`;
      card.addEventListener('click', () => openMusicPlayer(song.id));
      card.addEventListener('keypress', e => { if(e.key === 'Enter' || e.key === ' ') openMusicPlayer(song.id); });
      grid.appendChild(card);
    }
  }
  document.querySelectorAll('.music-menu-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.music-menu-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      renderMusicGrid(btn.dataset.menu);
    });
  });

  // Music Player controls and close
  let currentSong = null;
  const playerModal = document.getElementById('music-player-modal');
  const playerAlbumArt = document.getElementById('player-album-art');
  const playerTitle = document.getElementById('player-title');
  const playerArtist = document.getElementById('player-artist');
  const playerLyrics = document.getElementById('player-lyrics');
  const playPauseBtn = document.getElementById('play-pause-btn');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const closeBtn = document.getElementById('music-player-close-btn');

  function openMusicPlayer(songId) {
    const song = state.musicData.find(s => s.id == songId);
    if(!song) return;
    currentSong = song;
    playerAlbumArt.src = song.albumArt;
    playerTitle.textContent = song.title;
    playerArtist.textContent = song.artist;
    playerLyrics.textContent = song.lyrics || '(Tidak ada lirik)';
    playerModal.classList.add('active');
    playerModal.setAttribute('aria-hidden', 'false');
    state.isPlaying = true;
    updatePlayPauseButton();
    addToPlayHistory(song);
  }
  playPauseBtn.addEventListener('click', () => {
    state.isPlaying = !state.isPlaying;
    updatePlayPauseButton();
  });
  function updatePlayPauseButton(){
    playPauseBtn.textContent = state.isPlaying ? '❚❚' : '▶';
  }
  prevBtn.addEventListener('click', () => {
    if(!currentSong) return;
    let idx = state.musicData.findIndex(s => s.id == currentSong.id);
    idx = (idx - 1 + state.musicData.length) % state.musicData.length;
    openMusicPlayer(state.musicData[idx].id);
  });
  nextBtn.addEventListener('click', () => {
    if(!currentSong) return;
    let idx = state.musicData.findIndex(s => s.id == currentSong.id);
    idx = (idx + 1) % state.musicData.length;
    openMusicPlayer(state.musicData[idx].id);
  });
  closeBtn.addEventListener('click', () => {
    playerModal.classList.remove('active');
    playerModal.setAttribute('aria-hidden', 'true');
    currentSong = null;
    state.isPlaying = false;
  });
  function addToPlayHistory(song){
    const existingIdx = state.playHistory.findIndex(s => s.id == song.id);
    if(existingIdx !== -1) state.playHistory.splice(existingIdx,1);
    state.playHistory.push(song);
    if(state.playHistory.length>30) state.playHistory.shift();
  }

  // Video Page: Manage videos from 7clouds uploads (limited demo), with dummy values for views/date
  const videoPlayerIframe = document.getElementById('video-player');
  const videoChannel = document.getElementById('video-channel');
  const videoViews = document.getElementById('video-views');
  const videoDate = document.getElementById('video-date');
  const likeBtn = document.getElementById('like-btn');
  const dislikeBtn = document.getElementById('dislike-btn');
  const shareBtn = document.getElementById('share-btn');
  const subscribeBtn = document.getElementById('subscribe-btn');
  const commentsList = document.getElementById('comments-list');
  const addCommentForm = document.getElementById('add-comment');
  const commentText = document.getElementById('comment-text');
  const recommendedVideos = document.getElementById('recommended-videos');

  // Initial video ids fetched from a public channel https://www.youtube.com/@7clouds/videos is not possible via client-side only no API key available,
  // so we will use some curated video ids from channel manually for demo:
  const sevenCloudVideos = [
    {id:'VXRz-4Ee2fY', title: 'Dreams in Bloom', views: 150000, date: '2022-11-10', thumb:'https://img.youtube.com/vi/VXRz-4Ee2fY/hqdefault.jpg'},
    {id:'jQcs6ba_n_k', title: 'Waves of Serenity', views: 97000, date: '2023-01-07', thumb:'https://img.youtube.com/vi/jQcs6ba_n_k/hqdefault.jpg'},
    {id:'P-CJK15yO9E', title: 'Midnight Dance', views: 130000, date: '2022-12-20', thumb:'https://img.youtube.com/vi/P-CJK15yO9E/hqdefault.jpg'},
    {id:'WWHbqTlqdjo', title: 'When Here Is When There', views: 53000, date: '2023-02-15', thumb:'https://img.youtube.com/vi/WWHbqTlqdjo/hqdefault.jpg'},
    {id:'9fVyFogxmXI', title: 'Shining', views: 88000, date: '2023-03-01', thumb:'https://img.youtube.com/vi/9fVyFogxmXI/hqdefault.jpg'},
  ];
  state.youtubeVideos = sevenCloudVideos;

  let currentVideoIndex = 0;

  function renderVideoCurrent(index) {
    if(index < 0 || index >= state.youtubeVideos.length) return;
    currentVideoIndex = index;
    const video = state.youtubeVideos[index];
    videoPlayerIframe.src = `https://www.youtube.com/embed/${video.id}`;
    videoChannel.textContent = '7clouds Media';
    videoViews.textContent = video.views.toLocaleString();
    videoDate.textContent = video.date;
    state.videoLiked = false;
    state.videoDisliked = false;
    state.subscribed = false;
    updateVideoButtons();

    // render comments dummy
    state.comments = [
      {author:'Rina', text:'Keren videonya!', time:'2 jam lalu'},
      {author:'Joko', text:'Lagu favorit saya!', time:'1 jam lalu'},
    ];
    renderComments();

    renderRecommendedVideos();
  }
  function updateVideoButtons(){
    likeBtn.setAttribute('aria-pressed', state.videoLiked);
    dislikeBtn.setAttribute('aria-pressed', state.videoDisliked);
    subscribeBtn.setAttribute('aria-pressed', state.subscribed);
    likeBtn.style.backgroundColor = state.videoLiked ? '#00ff00' : '';
    dislikeBtn.style.backgroundColor = state.videoDisliked ? '#ff0000' : '';
    subscribeBtn.style.backgroundColor = state.subscribed ? '#8A2BE2' : '';
  }
  likeBtn.addEventListener('click', () => {
    state.videoLiked = !state.videoLiked;
    if(state.videoLiked) state.videoDisliked = false;
    updateVideoButtons();
  });
  dislikeBtn.addEventListener('click', () => {
    state.videoDisliked = !state.videoDisliked;
    if(state.videoDisliked) state.videoLiked = false;
    updateVideoButtons();
  });
  subscribeBtn.addEventListener('click', () => {
    state.subscribed = !state.subscribed;
    updateVideoButtons();
  });
  shareBtn.addEventListener('click', () => {
    const video = state.youtubeVideos[currentVideoIndex];
    if(video){
      const url = `https://www.youtube.com/watch?v=${video.id}`;
      navigator.clipboard.writeText(url);
      alert('Tautan video telah disalin ke clipboard!');
    }
  });
  function renderComments(){
    commentsList.innerHTML = '';
    if(state.comments.length === 0){
      commentsList.innerHTML = '<p>Belum ada komentar.</p>';
      return;
    }
    for(const c of state.comments){
      const div = document.createElement('div');
      div.className = 'comment';
      div.innerHTML = `<strong>${c.author}</strong><span class="timestamp">${c.time}</span><div>${c.text}</div>`;
      commentsList.appendChild(div);
    }
  }
  addCommentForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const txt = commentText.value.trim();
    if(txt.length === 0) return;
    state.comments.push({author:'Anonim', text: txt, time:'Baru saja'});
    commentText.value = '';
    renderComments();
  });
  function renderRecommendedVideos(){
    recommendedVideos.innerHTML = '<h4>Rekomendasi</h4>';
    state.youtubeVideos.forEach((video, idx) => {
      const div = document.createElement('div');
      div.className = 'search-result-card';
      div.innerHTML = `
        <img class="search-result-thumb" src="${video.thumb}" alt="Thumbnail ${video.title}" />
        <div class="search-result-info">
          <div class="search-result-title">${video.title}</div>
          <div class="search-result-meta">YouTube • ${video.views.toLocaleString()} views</div>
        </div>
      `;
      div.tabIndex = 0;
      div.style.cursor = 'pointer';
      div.addEventListener('click', () => renderVideoCurrent(idx));
      div.addEventListener('keypress', e => {
        if(e.key === 'Enter' || e.key === ' ') renderVideoCurrent(idx);
      });
      recommendedVideos.appendChild(div);
    });
  }

  // Live: embed from given YouTube live video ids and chat dummy
  const liveVideoEmbed = document.getElementById('live-video-embed');
  const liveSelectors = document.getElementById('live-selectors');
  const liveViewersSpan = document.getElementById('live-viewers');
  const chatMessagesDiv = document.getElementById('chat-messages');
  const chatInput = document.getElementById('chat-input');
  const chatSendBtn = document.getElementById('chat-send-btn');

  const liveVideoIds = ['U4Ux0ePA_2U','lOK8WcyVmSQ','36YnV9STBqc'];
  let activeLiveIndex = 0;

  function setupLiveStreams(){
    liveVideoEmbed.src = `https://www.youtube.com/embed/${liveVideoIds[activeLiveIndex]}?autoplay=1&mute=1`;
    liveViewersSpan.textContent = Math.floor(150 + Math.random()*250);
    liveSelectors.querySelectorAll('button').forEach((btn, idx) => {
      btn.classList.toggle('active', idx === activeLiveIndex);
      btn.disabled = idx === activeLiveIndex;
    });
    state.chatMessages = [
      {user:'MusicFan', text:'Wah keren nih live!', time:'2 menit lalu'},
      {user:'Joe', text:'Nonton sambil kerja!', time:'Baru saja'}
    ];
    renderChatMessages();
  }
  liveSelectors.querySelectorAll('button').forEach((btn, idx) => {
    btn.addEventListener('click', () => {
      activeLiveIndex = idx;
      setupLiveStreams();
    });
  });
  function renderChatMessages(){
    chatMessagesDiv.innerHTML = '';
    for(const msg of state.chatMessages){
      const p = document.createElement('p');
      p.textContent = `${msg.user}: ${msg.text}`;
      chatMessagesDiv.appendChild(p);
    }
    chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
  }
  chatSendBtn.addEventListener('click', () => {
    const txt = chatInput.value.trim();
    if(txt.length === 0) return;
    state.chatMessages.push({user:'You', text: txt, time:'Baru saja'});
    chatInput.value = '';
    renderChatMessages();
  });
  chatInput.addEventListener('keydown', (e) => {
    if(e.key==='Enter' && !e.shiftKey){
      e.preventDefault();
      chatSendBtn.click();
    }
  });

  // Profile page, login/register, search, avatar etc remain unchanged...
  // For brevity, login/register, profile, search etc handlers as previous version remain the same, omitted here.

  // Fetch latest music from Jamendo API for homepage
  async function fetchLatestMusic(){
    const container = document.getElementById('latest-music-list');
    container.innerHTML = '';
    loadingOverlay.classList.remove('hidden');
    try {
      const res = await fetch('https://api.jamendo.com/v3.0/tracks/?client_id=3890adb1&format=jsonpretty&limit=15&audioformat=mp31&order=popularity_desc');
      const data = await res.json();
      if(data && data.results){
        state.latestMusic = data.results.map(track => ({
          id: track.id,
          title: track.name,
          artist: track.artist_name,
          albumArt: track.album_image || 'https://via.placeholder.com/140x140?text=No+Image',
          audio: track.audio,
          lyrics: '',
        }));
        state.musicData = [...state.latestMusic];
        renderLatestMusicSlider();
      }
    } catch(e){
      container.innerHTML = '<p>Gagal memuat musik terbaru.</p>';
    } finally {
      loadingOverlay.classList.add('hidden');
    }
  }
  function renderLatestMusicSlider(){
    const container = document.getElementById('latest-music-list');
    container.innerHTML = '';
    if(state.latestMusic.length === 0){
      container.innerHTML = '<p>Tidak ada musik terbaru.</p>';
      return;
    }
    state.latestMusic.forEach(song => {
      const card = document.createElement('div');
      card.className = 'latest-music-card';
      card.tabIndex = 0;
      card.setAttribute('role', 'button');
      card.dataset.id = song.id;
      card.innerHTML = `
        <img src="${song.albumArt}" alt="Album art ${song.title}" class="latest-music-thumb" />
        <div class="latest-music-info">
          <div class="latest-music-title">${song.title}</div>
          <div class="latest-music-artist">${song.artist}</div>
        </div>
      `;
      card.addEventListener('click', () => openMusicPlayer(song.id));
      card.addEventListener('keypress', (e) => {
        if(e.key === 'Enter' || e.key === ' ') openMusicPlayer(song.id);
      });
      container.appendChild(card);
    });
  }

  // Initialization
  setActivePage('home');

</script>

</body>
</html>

